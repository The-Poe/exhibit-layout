{"version":3,"file":"static/js/929.10dbd53c.chunk.js","mappings":"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","sources":["webpack://react17-template/./src/components/pages/checkout/Checkout.module.scss?a7fe","webpack://react17-template/./src/components/pages/checkout/CheckoutItem.module.scss?4cfc","components/pages/checkout/CheckoutItem.js","components/pages/checkout/Checkout.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"chkoutContainer\":\"Checkout_chkoutContainer__CORgx\",\"sectionProgress\":\"Checkout_sectionProgress__XzU-8\",\"progress\":\"Checkout_progress__dLigo\",\"progessStatuses\":\"Checkout_progessStatuses__SLhjf\",\"progessStatus\":\"Checkout_progessStatus__tZ6Sg\",\"progressDot\":\"Checkout_progressDot__YFfs-\",\"chkoutContent\":\"Checkout_chkoutContent__C6s6L\",\"chkoutItems\":\"Checkout_chkoutItems__e-4aK\",\"chkoutCustomInfo\":\"Checkout_chkoutCustomInfo__ambMP\",\"customerFormWrapper\":\"Checkout_customerFormWrapper__zhsoI\",\"formTitle\":\"Checkout_formTitle__66h8T\",\"formField\":\"Checkout_formField__+8QCh\",\"coupleEffect\":\"Checkout_coupleEffect__JuJrV\",\"isCoupleEffect\":\"Checkout_isCoupleEffect__HkEZr\",\"subTotalSection\":\"Checkout_subTotalSection__+vUOf\",\"summing\":\"Checkout_summing__mH0Ge\",\"mh\":\"Checkout_mh__HSlpk\",\"total\":\"Checkout_total__d2Cf+\",\"chkoutConfirm\":\"Checkout_chkoutConfirm__PhjjX\",\"btnRewind\":\"Checkout_btnRewind__aZjUu\",\"btnNext\":\"Checkout_btnNext__RbtiN\",\"btnConfirm\":\"Checkout_btnConfirm__yobiQ\"};","// extracted by mini-css-extract-plugin\nexport default {\"chkoutItem\":\"CheckoutItem_chkoutItem__5ZbPj\",\"deleteItemWrapper\":\"CheckoutItem_deleteItemWrapper__e3cV1\",\"deleteItem\":\"CheckoutItem_deleteItem__j+wK2\",\"itemPic\":\"CheckoutItem_itemPic__9AvDr\",\"itemInfo\":\"CheckoutItem_itemInfo__442TR\",\"itemInfoTitle\":\"CheckoutItem_itemInfoTitle__FIfOX\",\"itemInfoDate\":\"CheckoutItem_itemInfoDate__sy7ka\",\"mh\":\"CheckoutItem_mh__OCvNL\",\"inlineBar\":\"CheckoutItem_inlineBar__pBN6H\",\"itemInfoType\":\"CheckoutItem_itemInfoType__5Vwyg\",\"itemInfoPrice\":\"CheckoutItem_itemInfoPrice__UJlKW\",\"itemAdjust\":\"CheckoutItem_itemAdjust__A9G3X\",\"minusWrapper\":\"CheckoutItem_minusWrapper__tSY9v\",\"minus\":\"CheckoutItem_minus__fe4x4\",\"itemQty\":\"CheckoutItem_itemQty__L4duV\",\"plus\":\"CheckoutItem_plus__mNnl7\"};","import styles from \"./CheckoutItem.module.scss\";\nimport { useDispatch } from \"react-redux\";\nimport { cartActions } from \"store/cartSlice\";\n\nconst CheckoutItem = (props) => {\n  const {\n    id,\n    picUrl,\n    title,\n    startDate,\n    startMon,\n    endDate,\n    endMonth,\n    price,\n    quantity,\n    totalPrice,\n  } = props;\n  const dispatch = useDispatch();\n  const plusOneItemHandler = () => {\n    dispatch(\n      cartActions.addItemToCart({\n        product: {\n          id,\n          picUrl,\n          title,\n          startDate,\n          startMon,\n          endDate,\n          endMonth,\n          price,\n          quantity,\n          totalPrice,\n        },\n        quantity: 1,\n      })\n    );\n  };\n  const minusOneItemHandler = () => {\n    dispatch(cartActions.removeOneItemFromCart(id));\n  };\n\n  const deleteItemHandler = () => {\n    dispatch(cartActions.deleteItemFromCart(id));\n  };\n\n  return (\n    <div className={`${styles.chkoutItem}`}>\n      <div className={`${styles.deleteItemWrapper}`}>\n        <div className={`${styles.deleteItem}`} onClick={deleteItemHandler}>\n          ✖\n        </div>\n      </div>\n      <div\n        className={`${styles.itemPic}`}\n        style={{\n          width: \"12vmax\",\n          height: \"auto\",\n          backgroundRepeat: \"no-repeat\",\n          backgroundPosition: \"center\",\n          backgroundSize: \"cover\",\n          backgroundImage: `url(${props.picUrl}`,\n        }}\n      ></div>\n      <div className={`${styles.itemInfo}`}>\n        <div className={`${styles.itemInfoTitle}`}>{props.title}</div>\n        <div className={`${styles.itemInfoDate}`}>\n          <span className={`${styles.startDay}`}>{props.startDate}</span>\n          <span className={`${styles.startMon}`}> {props.startMonth}</span>\n          <div className={`${styles.inlineBar}`}></div>\n          <span className={`${styles.endDay}`}>{props.endDate}</span>\n          <span className={`${styles.endMon}`}> {props.endMonth}</span>\n        </div>\n        <div className={`${styles.itemInfoType}`}>全票</div>\n      </div>\n      <div className={`${styles.itemInfoPrice}`}>\n        <span className={`${styles.infoCurrency}`}>NT$</span>\n        <span className={`${styles.infoTotal}`}>{props.totalPrice}</span>\n      </div>\n      <div className={`${styles.itemAdjust}`}>\n        <div\n          className={`${styles.minusWrapper} mh`}\n          onClick={minusOneItemHandler}\n        >\n          <div className={`${styles.minus}`}></div>\n        </div>\n        <div className={`${styles.itemQty} mh`}>{props.quantity}</div>\n        <div className={`${styles.plus} mh`} onClick={plusOneItemHandler}>\n          +\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default CheckoutItem;\n","import {\n  addDoc,\n  collection,\n  getDocs,\n  limit,\n  query,\n  where,\n} from \"firebase/firestore\";\nimport { firestore } from \"firebaseConfig\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { cartActions } from \"store/cartSlice\";\nimport { orderInfoActions } from \"store/orderInfoSlice\";\nimport styles from \"./Checkout.module.scss\";\nimport CheckoutItem from \"./CheckoutItem\";\n\nconst Checkout = () => {\n  const [checkoutStatus, setCheckoutStatus] = useState(1);\n  const authUser = useSelector((state) => state.authUserReducer.authUser);\n\n  const cart = useSelector((state) => state.cartReducer);\n  const { items, sumPrice } = cart;\n  const dispatch = useDispatch();\n\n  const [email, setEmail] = useState(\"\");\n  const [cusomerName, setCusomerName] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [couponCode, setCouponCode] = useState(\"\");\n  const [isCouponEffect, setIsCouponEffect] = useState(false);\n  const [couponDiscount, setCouponDiscount] = useState(0);\n  const [creditCard, setCreditCard] = useState(\"\");\n  const [creditCardDate, setCreditCardDate] = useState(null);\n  const [secureCode, setSecureCode] = useState(\"\");\n  const [finalPrice, setfinalPrice] = useState(0);\n  //TODO: validation\n\n  const emailInputRef = useRef();\n  const customerNameInputRef = useRef();\n  const phoneInputRef = useRef();\n  const couponCodeInputRef = useRef();\n  const creditCardInputRef = useRef();\n  const creditCardDateInputRef = useRef();\n  const secureCodeInputRef = useRef();\n\n  const emailOnChange = (e) => {\n    setEmail(emailInputRef.current.value);\n    console.log(email);\n  };\n  const customerNameOnChange = () => {\n    setCusomerName(customerNameInputRef.current.value);\n  };\n  const phoneOnChange = () => {\n    setPhone(phoneInputRef.current.value);\n  };\n  const couponCodeOnChange = () => {\n    setCouponCode(couponCodeInputRef.current.value);\n    console.log(\"couponCodeOnChange called\");\n  };\n\n  useEffect(() => {\n    /*To look up Coupon discount*/\n    /****************************/\n    /**Query with multiple docs**/\n    /****************************/\n    async function queryForDocs() {\n      console.log(\"queryForDocs() called\");\n      const customerOrderQuery = query(\n        collection(firestore, \"campaigns\"),\n        where(\"couponCode\", \"==\", couponCode),\n        limit(1)\n      );\n      const querySnapshot = await getDocs(customerOrderQuery);\n      console.log(\"couponCode:\", couponCode);\n      console.log(\"querySnapshot.docs:\", querySnapshot.docs);\n      if (querySnapshot.docs.length === 0) {\n        setCouponDiscount(0);\n        setIsCouponEffect(false);\n        setfinalPrice(sumPrice);\n      } else if (querySnapshot.docs.length > 0) {\n        querySnapshot.forEach((snap) => {\n          console.log(\n            `Query Doc ${snap.id} contains ${JSON.stringify(snap.data())}`\n          );\n          setCouponDiscount(snap.data().couponDiscount);\n          if (snap.data().couponType.toLowerCase() === \"minus\") {\n            setfinalPrice(sumPrice - couponDiscount);\n          }\n          setIsCouponEffect(true);\n        });\n      }\n    }\n    queryForDocs();\n  }, [couponCode, couponDiscount, sumPrice]);\n\n  const creditCardOnChange = () => {\n    setCreditCard(creditCardInputRef.current.value);\n  };\n  const creditCardDateOnChange = () => {\n    setCreditCardDate(creditCardDateInputRef.current.value);\n  };\n  const secureCodeOnChange = () => {\n    setSecureCode(secureCodeInputRef.current.value);\n  };\n\n  const nextStepHandler = () => {\n    if (checkoutStatus < 3) setCheckoutStatus(checkoutStatus + 1);\n    console.log(\"checkoutStatus:\", checkoutStatus);\n  };\n\n  const lastStepHandler = () => {\n    if (checkoutStatus > 1) setCheckoutStatus(checkoutStatus - 1);\n    console.log(\"checkoutStatus:\", checkoutStatus);\n  };\n\n  const onConfirmOrder = () => {\n    const orderDetail = {\n      email,\n      cusomerName,\n      phone,\n      couponCode,\n      couponDiscount,\n      creditCard,\n      creditCardDate,\n      secureCode,\n      finalPrice,\n      items,\n    };\n\n    /*send to Firestore*/\n    const authUserJSON = JSON.parse(authUser);\n    let authUserEmail = \"\";\n    if (authUserJSON) {\n      if (authUser) {\n        authUserEmail = JSON.parse(authUser).email;\n      }\n    }\n    //collection(自動配給子集合使用,ID可以用addDoc回傳的id)\n    const usersCollection = collection(\n      firestore,\n      `orders/${authUserEmail}/orderDetails`\n    );\n    const addDocToFirebase = async () => {\n      addDoc(usersCollection, orderDetail) //用隨機ID新增\n        .then((response) => {\n          console.log(\"the addDoc() promise has fullfilled! \");\n          console.log(\"the response is:\", response);\n          console.log(\"the response.id is:\", response.id);\n          dispatch(\n            orderInfoActions.replaceOrderId({\n              orderId: response.id,\n            })\n          );\n        }) //won't run when offline\n        .catch((err) => console.log(\"the addDoc() got error:\", err));\n    };\n    addDocToFirebase();\n\n    dispatch(orderInfoActions.replaceOrderItems({ items }));\n\n    dispatch(\n      cartActions.replaceCart({\n        items: [],\n        totalQuantity: 0,\n        sumPrice: 0,\n      })\n    );\n  };\n\n  return (\n    <>\n      <div className={`${styles.chkoutContainer}`}>\n        <div className={`${styles.sectionProgress}`}>\n          <div className={`${styles.progress}`}></div>\n          <div className={`${styles.progessStatuses}`}>\n            <div className={`${styles.progessStatus}`}>\n              <div className={`${styles.progressDot} bgPink`}></div>\n              確認訂單\n            </div>\n            <div className={`${styles.progessStatus}`}>\n              <div\n                className={`${styles.progressDot} ${\n                  checkoutStatus >= 2 ? \"bgPink\" : \"bgWhite\"\n                } `}\n              ></div>\n              填寫訂單資訊\n            </div>\n            <div className={`${styles.progessStatus}`}>\n              <div\n                className={`${styles.progressDot} ${\n                  checkoutStatus >= 3 ? \"bgPink\" : \"bgWhite\"\n                }`}\n              ></div>\n              填寫付款資訊\n            </div>\n            <div className={`${styles.progessStatus}`}>\n              <div\n                className={`${styles.progressDot} ${\n                  checkoutStatus >= 4 ? \"bgPink\" : \"bgWhite\"\n                }`}\n              ></div>\n              完成訂購\n            </div>\n          </div>\n        </div>\n        <div className={`${styles.chkoutContent}`}>\n          <div className={`${styles.chkoutItems}`}>\n            {items &&\n              items.map((item) => (\n                <CheckoutItem\n                  key={item.id}\n                  id={item.id}\n                  picUrl={item.picUrl}\n                  title={item.title}\n                  startDate={item.startDate}\n                  startMon={item.startMonth}\n                  endDate={item.endDate}\n                  endMonth={item.endMonth}\n                  price={item.price}\n                  quantity={item.quantity}\n                  totalPrice={item.totalPrice}\n                />\n              ))}\n          </div>\n        </div>\n        <div className={`${styles.chkoutCustomInfo}`}>\n          <div className={`${styles.customerFormWrapper}`}>\n            {checkoutStatus === 2 && (\n              <>\n                <div className={`${styles.formTitle}`}>訂購人資訊</div>\n                <form action=\"\">\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"email\">Email</label>\n                    <br />\n                    <input\n                      type=\"email\"\n                      name=\"email\"\n                      placeholder=\"example@gmail.com\"\n                      ref={emailInputRef}\n                      onChange={emailOnChange}\n                    ></input>\n                  </div>\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"name\">姓名</label>\n                    <br />\n                    <input\n                      type=\"text\"\n                      name=\"name\"\n                      placeholder=\"請輸入姓名\"\n                      ref={customerNameInputRef}\n                      onChange={customerNameOnChange}\n                    ></input>\n                  </div>\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"contact\">連絡電話</label>\n                    <br />\n                    <input\n                      type=\"tel\"\n                      name=\"contact\"\n                      placeholder=\"請輸入電話\"\n                      ref={phoneInputRef}\n                      onChange={phoneOnChange}\n                    ></input>\n                  </div>\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"coupon\">優惠碼</label>\n                    <br />\n                    <input\n                      type=\"text\"\n                      name=\"coupon\"\n                      placeholder=\"TG87526\"\n                      ref={couponCodeInputRef}\n                      onChange={couponCodeOnChange}\n                    ></input>\n                    <div className={`${styles.coupleEffect}`}>\n                      {isCouponEffect && \"優惠碼已生效\"}\n                      {!isCouponEffect && \"無效優惠碼\"}\n                    </div>\n                  </div>\n                </form>\n              </>\n            )}\n            {checkoutStatus === 3 && (\n              <>\n                <div className={`${styles.formTitle}`}>付款資訊</div>\n                <form action=\"\">\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"credit\">信用卡帳號</label>\n                    <br />\n                    <input\n                      type=\"text\"\n                      name=\"credit\"\n                      placeholder=\"xxxx-xxxx-xxxx-xxxx\"\n                      ref={creditCardInputRef}\n                      onChange={creditCardOnChange}\n                    ></input>\n                  </div>\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"validDate\">有效日期</label>\n                    <br />\n                    <input\n                      type=\"month\"\n                      name=\"validDate\"\n                      placeholder=\"(MM/YY)\"\n                      ref={creditCardDateInputRef}\n                      onChange={creditCardDateOnChange}\n                    ></input>\n                  </div>\n                  <div className={`${styles.formField}`}>\n                    <label htmlFor=\"security\">安全碼</label>\n                    <br />\n                    <input\n                      type=\"password\"\n                      name=\"security\"\n                      max=\"3\"\n                      placeholder=\"請輸入安全碼\"\n                      ref={secureCodeInputRef}\n                      onChange={secureCodeOnChange}\n                    ></input>\n                  </div>\n                </form>\n              </>\n            )}\n          </div>\n          <div className={`${styles.subTotalSection}`}>\n            <div className={`${styles.summing}`}>\n              <span className={`${styles.subtotalText} mh`}>小計</span>\n              <span className={`${styles.subtotalInfo} mh`}>\n                <span className={`${styles.infoCurrency}`}>NT$</span>\n                <span className={`${styles.infoTotal}`}>{sumPrice}</span>\n              </span>\n            </div>\n            {checkoutStatus !== 1 && (\n              <>\n                <div className={`${styles.summing}`}>\n                  <span className={`${styles.subtotalText} mh`}>折扣</span>\n                  <span className={`${styles.subtotalInfo} mh`}>\n                    <span className={`${styles.infoCurrency}`}>-NT$</span>\n                    <span className={`${styles.infoCurrency}`}>\n                      {couponDiscount}\n                    </span>\n                  </span>\n                </div>\n                <div className={`${styles.summing} total`}>\n                  <span className={`${styles.subtotalText} mh`}>總金額</span>\n                  <span className={`${styles.subtotalInfo} mh`}>\n                    <span className={`${styles.infoCurrency}`}>NT$</span>\n                    <span className={`${styles.infoTotal}`}>{finalPrice}</span>\n                  </span>\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className={`${styles.chkoutConfirm}`}>\n        <div\n          onClick={lastStepHandler}\n          className={`${checkoutStatus === 1 && \"invisible\"} ${\n            styles.btnRewind\n          }   borPurple textPurple`}\n        >\n          返回\n        </div>\n        {checkoutStatus < 3 && (\n          <div\n            onClick={nextStepHandler}\n            className={`${styles.btnNext} textWhite bgPurple`}\n          >\n            下一步\n          </div>\n        )}\n        {checkoutStatus === 3 && (\n          <Link to=\"/checkoutDone\">\n            <div\n              onClick={onConfirmOrder}\n              className={`${styles.btnConfirm} textWhite bgPurple`}\n            >\n              確認結帳\n            </div>\n          </Link>\n        )}\n      </div>\n    </>\n  );\n};\nexport default Checkout;\n"],"names":["props","id","picUrl","title","startDate","startMon","endDate","endMonth","price","quantity","totalPrice","dispatch","useDispatch","className","styles","onClick","cartActions","style","width","height","backgroundRepeat","backgroundPosition","backgroundSize","backgroundImage","startMonth","product","checkoutStatus","setCheckoutStatus","useState","authUser","useSelector","state","authUserReducer","cart","cartReducer","items","sumPrice","email","setEmail","cusomerName","setCusomerName","phone","setPhone","couponCode","setCouponCode","isCouponEffect","setIsCouponEffect","couponDiscount","setCouponDiscount","creditCard","setCreditCard","creditCardDate","setCreditCardDate","secureCode","setSecureCode","finalPrice","setfinalPrice","emailInputRef","useRef","customerNameInputRef","phoneInputRef","couponCodeInputRef","creditCardInputRef","creditCardDateInputRef","secureCodeInputRef","useEffect","async","console","log","customerOrderQuery","query","collection","firestore","where","limit","querySnapshot","getDocs","docs","length","forEach","snap","JSON","stringify","data","couponType","toLowerCase","queryForDocs","map","item","action","htmlFor","type","name","placeholder","ref","onChange","e","current","value","max","to","orderDetail","authUserEmail","parse","usersCollection","addDoc","then","response","orderInfoActions","orderId","catch","err","addDocToFirebase","totalQuantity"],"sourceRoot":""}