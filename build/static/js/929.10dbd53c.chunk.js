"use strict";(globalThis.webpackChunkreact17_template=globalThis.webpackChunkreact17_template||[]).push([[929],{929:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var a=t(62),c=t(753),o=t(791),n=t(434),r=t(523),i=t(783),l=t(945);const m={chkoutContainer:"Checkout_chkoutContainer__CORgx",sectionProgress:"Checkout_sectionProgress__XzU-8",progress:"Checkout_progress__dLigo",progessStatuses:"Checkout_progessStatuses__SLhjf",progessStatus:"Checkout_progessStatus__tZ6Sg",progressDot:"Checkout_progressDot__YFfs-",chkoutContent:"Checkout_chkoutContent__C6s6L",chkoutItems:"Checkout_chkoutItems__e-4aK",chkoutCustomInfo:"Checkout_chkoutCustomInfo__ambMP",customerFormWrapper:"Checkout_customerFormWrapper__zhsoI",formTitle:"Checkout_formTitle__66h8T",formField:"Checkout_formField__+8QCh",coupleEffect:"Checkout_coupleEffect__JuJrV",isCoupleEffect:"Checkout_isCoupleEffect__HkEZr",subTotalSection:"Checkout_subTotalSection__+vUOf",summing:"Checkout_summing__mH0Ge",mh:"Checkout_mh__HSlpk",total:"Checkout_total__d2Cf+",chkoutConfirm:"Checkout_chkoutConfirm__PhjjX",btnRewind:"Checkout_btnRewind__aZjUu",btnNext:"Checkout_btnNext__RbtiN",btnConfirm:"Checkout_btnConfirm__yobiQ"},d={chkoutItem:"CheckoutItem_chkoutItem__5ZbPj",deleteItemWrapper:"CheckoutItem_deleteItemWrapper__e3cV1",deleteItem:"CheckoutItem_deleteItem__j+wK2",itemPic:"CheckoutItem_itemPic__9AvDr",itemInfo:"CheckoutItem_itemInfo__442TR",itemInfoTitle:"CheckoutItem_itemInfoTitle__FIfOX",itemInfoDate:"CheckoutItem_itemInfoDate__sy7ka",mh:"CheckoutItem_mh__OCvNL",inlineBar:"CheckoutItem_inlineBar__pBN6H",itemInfoType:"CheckoutItem_itemInfoType__5Vwyg",itemInfoPrice:"CheckoutItem_itemInfoPrice__UJlKW",itemAdjust:"CheckoutItem_itemAdjust__A9G3X",minusWrapper:"CheckoutItem_minusWrapper__tSY9v",minus:"CheckoutItem_minus__fe4x4",itemQty:"CheckoutItem_itemQty__L4duV",plus:"CheckoutItem_plus__mNnl7"};var h=t(184);const u=e=>{const{id:s,picUrl:t,title:a,startDate:c,startMon:o,endDate:r,endMonth:l,price:m,quantity:u,totalPrice:p}=e,x=(0,n.I0)();return(0,h.jsxs)("div",{className:`${d.chkoutItem}`,children:[(0,h.jsx)("div",{className:`${d.deleteItemWrapper}`,children:(0,h.jsx)("div",{className:`${d.deleteItem}`,onClick:()=>{x(i.U.deleteItemFromCart(s))},children:"\u2716"})}),(0,h.jsx)("div",{className:`${d.itemPic}`,style:{width:"12vmax",height:"auto",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:`url(${e.picUrl}`}}),(0,h.jsxs)("div",{className:`${d.itemInfo}`,children:[(0,h.jsx)("div",{className:`${d.itemInfoTitle}`,children:e.title}),(0,h.jsxs)("div",{className:`${d.itemInfoDate}`,children:[(0,h.jsx)("span",{className:`${d.startDay}`,children:e.startDate}),(0,h.jsxs)("span",{className:`${d.startMon}`,children:[" ",e.startMonth]}),(0,h.jsx)("div",{className:`${d.inlineBar}`}),(0,h.jsx)("span",{className:`${d.endDay}`,children:e.endDate}),(0,h.jsxs)("span",{className:`${d.endMon}`,children:[" ",e.endMonth]})]}),(0,h.jsx)("div",{className:`${d.itemInfoType}`,children:"\u5168\u7968"})]}),(0,h.jsxs)("div",{className:`${d.itemInfoPrice}`,children:[(0,h.jsx)("span",{className:`${d.infoCurrency}`,children:"NT$"}),(0,h.jsx)("span",{className:`${d.infoTotal}`,children:e.totalPrice})]}),(0,h.jsxs)("div",{className:`${d.itemAdjust}`,children:[(0,h.jsx)("div",{className:`${d.minusWrapper} mh`,onClick:()=>{x(i.U.removeOneItemFromCart(s))},children:(0,h.jsx)("div",{className:`${d.minus}`})}),(0,h.jsx)("div",{className:`${d.itemQty} mh`,children:e.quantity}),(0,h.jsx)("div",{className:`${d.plus} mh`,onClick:()=>{x(i.U.addItemToCart({product:{id:s,picUrl:t,title:a,startDate:c,startMon:o,endDate:r,endMonth:l,price:m,quantity:u,totalPrice:p},quantity:1}))},children:"+"})]})]})},p=()=>{const[e,s]=(0,o.useState)(1),t=(0,n.v9)((e=>e.authUserReducer.authUser)),d=(0,n.v9)((e=>e.cartReducer)),{items:p,sumPrice:x}=d,_=(0,n.I0)(),[j,C]=(0,o.useState)(""),[f,N]=(0,o.useState)(""),[k,$]=(0,o.useState)(""),[g,v]=(0,o.useState)(""),[I,b]=(0,o.useState)(!1),[y,S]=(0,o.useState)(0),[D,T]=(0,o.useState)(""),[P,F]=(0,o.useState)(null),[R,U]=(0,o.useState)(""),[M,W]=(0,o.useState)(0),O=(0,o.useRef)(),w=(0,o.useRef)(),E=(0,o.useRef)(),q=(0,o.useRef)(),J=(0,o.useRef)(),L=(0,o.useRef)(),Q=(0,o.useRef)();(0,o.useEffect)((()=>{!async function(){console.log("queryForDocs() called");const e=(0,a.IO)((0,a.hJ)(c.R,"campaigns"),(0,a.ar)("couponCode","==",g),(0,a.b9)(1)),s=await(0,a.PL)(e);console.log("couponCode:",g),console.log("querySnapshot.docs:",s.docs),0===s.docs.length?(S(0),b(!1),W(x)):s.docs.length>0&&s.forEach((e=>{console.log(`Query Doc ${e.id} contains ${JSON.stringify(e.data())}`),S(e.data().couponDiscount),"minus"===e.data().couponType.toLowerCase()&&W(x-y),b(!0)}))}()}),[g,y,x]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:`${m.chkoutContainer}`,children:[(0,h.jsxs)("div",{className:`${m.sectionProgress}`,children:[(0,h.jsx)("div",{className:`${m.progress}`}),(0,h.jsxs)("div",{className:`${m.progessStatuses}`,children:[(0,h.jsxs)("div",{className:`${m.progessStatus}`,children:[(0,h.jsx)("div",{className:`${m.progressDot} bgPink`}),"\u78ba\u8a8d\u8a02\u55ae"]}),(0,h.jsxs)("div",{className:`${m.progessStatus}`,children:[(0,h.jsx)("div",{className:`${m.progressDot} ${e>=2?"bgPink":"bgWhite"} `}),"\u586b\u5beb\u8a02\u55ae\u8cc7\u8a0a"]}),(0,h.jsxs)("div",{className:`${m.progessStatus}`,children:[(0,h.jsx)("div",{className:`${m.progressDot} ${e>=3?"bgPink":"bgWhite"}`}),"\u586b\u5beb\u4ed8\u6b3e\u8cc7\u8a0a"]}),(0,h.jsxs)("div",{className:`${m.progessStatus}`,children:[(0,h.jsx)("div",{className:`${m.progressDot} ${e>=4?"bgPink":"bgWhite"}`}),"\u5b8c\u6210\u8a02\u8cfc"]})]})]}),(0,h.jsx)("div",{className:`${m.chkoutContent}`,children:(0,h.jsx)("div",{className:`${m.chkoutItems}`,children:p&&p.map((e=>(0,h.jsx)(u,{id:e.id,picUrl:e.picUrl,title:e.title,startDate:e.startDate,startMon:e.startMonth,endDate:e.endDate,endMonth:e.endMonth,price:e.price,quantity:e.quantity,totalPrice:e.totalPrice},e.id)))})}),(0,h.jsxs)("div",{className:`${m.chkoutCustomInfo}`,children:[(0,h.jsxs)("div",{className:`${m.customerFormWrapper}`,children:[2===e&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:`${m.formTitle}`,children:"\u8a02\u8cfc\u4eba\u8cc7\u8a0a"}),(0,h.jsxs)("form",{action:"",children:[(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"email",children:"Email"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"email",name:"email",placeholder:"example@gmail.com",ref:O,onChange:e=>{C(O.current.value),console.log(j)}})]}),(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"name",children:"\u59d3\u540d"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"text",name:"name",placeholder:"\u8acb\u8f38\u5165\u59d3\u540d",ref:w,onChange:()=>{N(w.current.value)}})]}),(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"contact",children:"\u9023\u7d61\u96fb\u8a71"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"tel",name:"contact",placeholder:"\u8acb\u8f38\u5165\u96fb\u8a71",ref:E,onChange:()=>{$(E.current.value)}})]}),(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"coupon",children:"\u512a\u60e0\u78bc"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"text",name:"coupon",placeholder:"TG87526",ref:q,onChange:()=>{v(q.current.value),console.log("couponCodeOnChange called")}}),(0,h.jsxs)("div",{className:`${m.coupleEffect}`,children:[I&&"\u512a\u60e0\u78bc\u5df2\u751f\u6548",!I&&"\u7121\u6548\u512a\u60e0\u78bc"]})]})]})]}),3===e&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:`${m.formTitle}`,children:"\u4ed8\u6b3e\u8cc7\u8a0a"}),(0,h.jsxs)("form",{action:"",children:[(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"credit",children:"\u4fe1\u7528\u5361\u5e33\u865f"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"text",name:"credit",placeholder:"xxxx-xxxx-xxxx-xxxx",ref:J,onChange:()=>{T(J.current.value)}})]}),(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"validDate",children:"\u6709\u6548\u65e5\u671f"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"month",name:"validDate",placeholder:"(MM/YY)",ref:L,onChange:()=>{F(L.current.value)}})]}),(0,h.jsxs)("div",{className:`${m.formField}`,children:[(0,h.jsx)("label",{htmlFor:"security",children:"\u5b89\u5168\u78bc"}),(0,h.jsx)("br",{}),(0,h.jsx)("input",{type:"password",name:"security",max:"3",placeholder:"\u8acb\u8f38\u5165\u5b89\u5168\u78bc",ref:Q,onChange:()=>{U(Q.current.value)}})]})]})]})]}),(0,h.jsxs)("div",{className:`${m.subTotalSection}`,children:[(0,h.jsxs)("div",{className:`${m.summing}`,children:[(0,h.jsx)("span",{className:`${m.subtotalText} mh`,children:"\u5c0f\u8a08"}),(0,h.jsxs)("span",{className:`${m.subtotalInfo} mh`,children:[(0,h.jsx)("span",{className:`${m.infoCurrency}`,children:"NT$"}),(0,h.jsx)("span",{className:`${m.infoTotal}`,children:x})]})]}),1!==e&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:`${m.summing}`,children:[(0,h.jsx)("span",{className:`${m.subtotalText} mh`,children:"\u6298\u6263"}),(0,h.jsxs)("span",{className:`${m.subtotalInfo} mh`,children:[(0,h.jsx)("span",{className:`${m.infoCurrency}`,children:"-NT$"}),(0,h.jsx)("span",{className:`${m.infoCurrency}`,children:y})]})]}),(0,h.jsxs)("div",{className:`${m.summing} total`,children:[(0,h.jsx)("span",{className:`${m.subtotalText} mh`,children:"\u7e3d\u91d1\u984d"}),(0,h.jsxs)("span",{className:`${m.subtotalInfo} mh`,children:[(0,h.jsx)("span",{className:`${m.infoCurrency}`,children:"NT$"}),(0,h.jsx)("span",{className:`${m.infoTotal}`,children:M})]})]})]})]})]})]}),(0,h.jsxs)("div",{className:`${m.chkoutConfirm}`,children:[(0,h.jsx)("div",{onClick:()=>{e>1&&s(e-1),console.log("checkoutStatus:",e)},className:`${1===e&&"invisible"} ${m.btnRewind}   borPurple textPurple`,children:"\u8fd4\u56de"}),e<3&&(0,h.jsx)("div",{onClick:()=>{e<3&&s(e+1),console.log("checkoutStatus:",e)},className:`${m.btnNext} textWhite bgPurple`,children:"\u4e0b\u4e00\u6b65"}),3===e&&(0,h.jsx)(r.rU,{to:"/checkoutDone",children:(0,h.jsx)("div",{onClick:()=>{const e={email:j,cusomerName:f,phone:k,couponCode:g,couponDiscount:y,creditCard:D,creditCardDate:P,secureCode:R,finalPrice:M,items:p};let s="";JSON.parse(t)&&t&&(s=JSON.parse(t).email);const o=(0,a.hJ)(c.R,`orders/${s}/orderDetails`);(async()=>{(0,a.ET)(o,e).then((e=>{console.log("the addDoc() promise has fullfilled! "),console.log("the response is:",e),console.log("the response.id is:",e.id),_(l.v.replaceOrderId({orderId:e.id}))})).catch((e=>console.log("the addDoc() got error:",e)))})(),_(l.v.replaceOrderItems({items:p})),_(i.U.replaceCart({items:[],totalQuantity:0,sumPrice:0}))},className:`${m.btnConfirm} textWhite bgPurple`,children:"\u78ba\u8a8d\u7d50\u5e33"})})]})]})}}}]);
//# sourceMappingURL=929.10dbd53c.chunk.js.map